{"version":3,"names":["_Cipher","require","_Cipher2","_NativeQuickCrypto","_Utils","_keys","RSAKeyVariant","exports","verifyAcceptableRsaKeyUse","name","isPublic","usages","checkSet","lazyDOMException","hasAnyNotIn","rsaOaepCipher","mode","key","data","label","type","CipherOrWrapMode","kWebCryptoCipherEncrypt","undefined","validateMaxBufferLength","NativeQuickCrypto","webcrypto","rsaCipher","keyObject","handle","RSA_OAEP","normalizeHashName","algorithm","hash","bufferLikeToArrayBuffer","rsaKeyGenerate","extractable","keyUsages","modulusLength","publicExponent","rawHash","publicExponentConverted","bigIntArrayToUnsignedInt","err","keypair","generateKeyPairPromise","cause","keyAlgorithm","publicUsages","privateUsages","getUsagesUnion","pub","PublicKeyObject","publicKey","CryptoKey","priv","PrivateKeyObject","privateKey","rsaExportKey","format","variant","KeyVariantLookup","rsaImportKey","keyData","createPublicKey","kty","d","length","use","checkUse","validateKeyOps","key_ops","ext","alg","HashContext","WebCrypto","createKeyObjectHandle","initJwk","KeyType","Private","asymmetricKeyType","keyDetail","Uint8Array"],"sourceRoot":"../../src","sources":["rsa.ts"],"mappings":"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","ignoreList":[]}
